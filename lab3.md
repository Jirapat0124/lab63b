# การทดลองที่3:การเขียนโปรแกรมเอ้าพุทสัญญาณดิจิทัล

## วัตถุประสงค์
* เพื่อศึกษาการรันโปรแกรมในไมโครคอนโทรเลอร์ แล้วนำเอ้าพุทสัญญาณไปเชื่อมกับอุปกรณ์อื่น

## อุปกรณ์ที่ใช้
1. ไมโครคอนโทรเลอร์(ESP-01)
2. สายต่อ USB
3. USB to sereal
4. adapter
5. หลอด LED
6. รีเลย์


## ศึกษาข้อมูลเบื้องต้น
[03 run example 3](https://www.youtube.com/watch?v=CCnN1WJsXQY)


## วิธีการทำการทดลอง
1. ต่อ adapter เข้ากับ USB to serial แล้วต่อบนตัวไมโครคอนโทรเลอร์
2. เปิด command prompt
3. เข้าโปรแกรมตัวอย่างโดยพิมพ์คำสั่ง cd pattani
4. เลือกโปรแกรมคำสั่ง cd 03_Output-Port
5. พิมพ์ vi src/maim.cpp เพื่อดูเนื้อหาโปรแกรม จะได้ดังนี้
```c
#include <Arduino.h>
#include <ESP8266WiFi.h>

int cnt = 0;

void setup()
{
	Serial.begin(115200);
	pinMode(0, OUTPUT);
	Serial.println("\n\n\n");
}

void loop()
{
	cnt++;
	if(cnt % 2) {
		Serial.println("========== ON ===========");
		digitalWrite(0, HIGH);
	} else {
		Serial.println("========== OFF ===========");
		digitalWrite(0, LOW);
	}
	delay(500);
}

```

6. อัปโหลดโปรแกรมลงในไมโครคอนโทรเลอร์โดยใช้คำสั่ง **pio run -t upload** พร้อมทั้งกดปุ่มสีดำค้างไว้เพื่ออัพโหลด และกดปุ่มสีแดงเพื่อรีเซ็ท จะขึ้นหน้าจอแบบนี้
![Image](https://i.imgur.com/W1OsA1a.jpg)
7. พิมพ์คำสั่ง pio device monitor เพื่อดูผลการรันโปรแกรม
![Image](https://i.imgur.com/jR7ZGJB.jpg)
8. ต่อ Relay เข้ากับ ไมโครคอนโทรเลอร์
9. นำตัวRelayมาต่อกับขั้วชาร์จ จะได้ยินเสียงเปิด-ปิดหน้าสัมผัสของสวิทซ์



## การบันทึกผลการทดลอง
* ทุกๆครึ่งวินาทีจะเป็น On และOff และledจะเปล่งแสงสว่างตอนโปรแกรมขึ้นเป็นOn
![Image](https://i.imgur.com/jR7ZGJB.jpg)

* เมื่อนำรีเลย์มาต่อกับไมโครคอนโทรเลอร์ และเชื่อมเข้ากับแบทเตอรี่ จะได้ยินเสียงเปิด-ปิดของสวิทซ์

## อภิปรายผลการทดลอง
จากการทดลอง เมื่ออัพโหลดโปรแกรมลงไปในไมโครคอนโทรเลอร์ และรันโปรแกรม บนหน้าจอจะแสดงผลonและoff สลับไปมาทุกๆครึ่งวินาที และเมื่อต่อเข้ากับหลอดไฟLED หลอดไฟก็จะสว่างเมื่อตัวโปรแกรมขึ้นคำว่าon
ส่วนถ้าโปรแกรมขึ้นคำว่า off หลอดไฟLEDก็จะดับ และไมโครคอนโทรเลอร์สามารถใช้ร่วมกับอุปกรณ์อื่นๆได้ ตัวอย่างเช่น Relay

## คำถามหลังการทดลอง
ทำไมหลอดไฟLED สีฟ้าจึงไม่ทำงาน
* เพราะที่LEDสีฟ้า ต่อเข้ากับport2 ซึ่งตัวโปรแกรมปล่อยoutput ไปทางport0
